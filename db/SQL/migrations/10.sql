DROP VIEW IF EXISTS FundamentalData;

CREATE VIEW FundamentalData AS
SELECT 
	-- FundamentalDataYahoo
	a.symbol, 
	a."asOfDate", 
	a."periodType", 
	a."currencyCode", 
	a."AccountsPayable", 
	a."AccountsReceivable", 
	a."AccruedInterestReceivable", 
	a."AccumulatedDepreciation", 
	a."AdditionalPaidInCapital", 
	a."AllowanceForDoubtfulAccountsReceivable", 
	a."Amortization", 
	a."AmortizationCashFlow", 
	a."AmortizationOfIntangibles", 
	a."AmortizationOfIntangiblesIncomeStatement", 
	a."AmortizationOfSecurities", 
	a."AssetImpairmentCharge", 
	a."AssetsHeldForSaleCurrent", 
	a."AvailableForSaleSecurities", 
	a."AverageDilutionEarnings", 
	a."BasicAverageShares", 
	a."BasicEPS", 
	a."BeginningCashPosition", 
	a."BuildingsAndImprovements", 
	a."CapitalExpenditure", 
	a."CapitalExpenditureReported", 
	a."CapitalLeaseObligations", 
	a."CapitalStock", 
	a."CashAndCashEquivalents", 
	a."CashCashEquivalentsAndShortTermInvestments", 
	a."CashDividendsPaid", 
	a."CashEquivalents", 
	a."CashFinancial", 
	a."CashFlowFromContinuingFinancingActivities", 
	a."CashFlowFromContinuingInvestingActivities", 
	a."CashFlowFromContinuingOperatingActivities", 
	a."CashFlowFromDiscontinuedOperation", 
	a."CashFlowsfromusedinOperatingActivitiesDirect", 
	a."CashFromDiscontinuedFinancingActivities", 
	a."CashFromDiscontinuedInvestingActivities", 
	a."CashFromDiscontinuedOperatingActivities", 
	a."ChangeInAccountPayable", 
	a."ChangeInAccruedExpense", 
	a."ChangeInCashSupplementalAsReported", 
	a."ChangeInDividendPayable", 
	a."ChangeInIncomeTaxPayable", 
	a."ChangeInInterestPayable", 
	a."ChangeInInventory", 
	a."ChangeInOtherCurrentAssets", 
	a."ChangeInOtherCurrentLiabilities", 
	a."ChangeInOtherWorkingCapital", 
	a."ChangeInPayable", 
	a."ChangeInPayablesAndAccruedExpense", 
	a."ChangeInPrepaidAssets", 
	a."ChangeInReceivables", 
	a."ChangeInTaxPayable", 
	a."ChangeInWorkingCapital", 
	a."ChangesInAccountReceivables", 
	a."ChangesInCash", 
	a."ClassesofCashPayments", 
	a."ClassesofCashReceiptsfromOperatingActivities", 
	a."CommercialPaper", 
	a."CommonStock", 
	a."CommonStockDividendPaid", 
	a."CommonStockEquity", 
	a."CommonStockIssuance", 
	a."CommonStockPayments", 
	a."ConstructionInProgress", 
	a."CostOfRevenue", 
	a."CurrentAccruedExpenses", 
	a."CurrentAssets", 
	a."CurrentCapitalLeaseObligation", 
	a."CurrentDebt", 
	a."CurrentDebtAndCapitalLeaseObligation", 
	a."CurrentDeferredAssets", 
	a."CurrentDeferredLiabilities", 
	a."CurrentDeferredRevenue", 
	a."CurrentDeferredTaxesAssets", 
	a."CurrentDeferredTaxesLiabilities", 
	a."CurrentLiabilities", 
	a."CurrentNotesPayable", 
	a."CurrentProvisions", 
	a."DeferredIncomeTax", 
	a."DeferredTax", 
	a."DefinedPensionBenefit", 
	a."Depletion", 
	a."DepletionIncomeStatement", 
	a."Depreciation", 
	a."DepreciationAmortizationDepletion", 
	a."DepreciationAmortizationDepletionIncomeStatement", 
	a."DepreciationAndAmortization", 
	a."DepreciationAndAmortizationInIncomeStatement", 
	a."DepreciationIncomeStatement", 
	a."DerivativeProductLiabilities", 
	a."DilutedAverageShares", 
	a."DilutedEPS", 
	a."DilutedNIAvailtoComStockholders", 
	a."DividendPaidCFO", 
	a."DividendReceivedCFO", 
	a."DividendsPayable", 
	a."DividendsReceivedCFI", 
	a."DuefromRelatedPartiesCurrent", 
	a."DuefromRelatedPartiesNonCurrent", 
	a."DuetoRelatedPartiesCurrent", 
	a."DuetoRelatedPartiesNonCurrent", 
	a."EBIT", 
	a."EBITDA", 
	a."EarningsFromEquityInterest", 
	a."EarningsFromEquityInterestNetOfTax", 
	a."EarningsLossesFromEquityInvestments", 
	a."EffectOfExchangeRateChanges", 
	a."EmployeeBenefits", 
	a."EndCashPosition", 
	a."EnterpriseValue", 
	a."EnterprisesValueEBITDARatio", 
	a."EnterprisesValueRevenueRatio", 
	a."ExcessTaxBenefitFromStockBasedCompensation", 
	a."ExciseTaxes", 
	a."FinancialAssets", 
	a."FinancialAssetsDesignatedasFairValueThroughProfitorLossTotal", 
	a."FinancingCashFlow", 
	a."FinishedGoods", 
	a."FixedAssetsRevaluationReserve", 
	a."ForeignCurrencyTranslationAdjustments", 
	a."FreeCashFlow", 
	a."GainLossOnInvestmentSecurities", 
	a."GainLossOnSaleOfBusiness", 
	a."GainLossOnSaleOfPPE", 
	a."GainOnSaleOfBusiness", 
	a."GainOnSaleOfPPE", 
	a."GainOnSaleOfSecurity", 
	a."GainsLossesNotAffectingRetainedEarnings", 
	a."GeneralAndAdministrativeExpense", 
	a."GeneralPartnershipCapital", 
	a."Goodwill", 
	a."GoodwillAndOtherIntangibleAssets", 
	a."GrossAccountsReceivable", 
	a."GrossPPE", 
	a."GrossProfit", 
	a."HedgingAssetsCurrent", 
	a."HeldToMaturitySecurities", 
	a."ImpairmentOfCapitalAssets", 
	a."IncomeTaxPaidSupplementalData", 
	a."IncomeTaxPayable", 
	a."InsuranceAndClaims", 
	a."InterestExpense", 
	a."InterestExpenseNonOperating", 
	a."InterestIncome", 
	a."InterestIncomeNonOperating", 
	a."InterestPaidCFF", 
	a."InterestPaidCFO", 
	a."InterestPaidSupplementalData", 
	a."InterestPayable", 
	a."InterestReceivedCFI", 
	a."InterestReceivedCFO", 
	a."InventoriesAdjustmentsAllowances", 
	a."Inventory", 
	a."InvestedCapital", 
	a."InvestingCashFlow", 
	a."InvestmentProperties", 
	a."InvestmentinFinancialAssets", 
	a."InvestmentsAndAdvances", 
	a."InvestmentsInOtherVenturesUnderEquityMethod", 
	a."InvestmentsinAssociatesatCost", 
	a."InvestmentsinJointVenturesatCost", 
	a."InvestmentsinSubsidiariesatCost", 
	a."IssuanceOfCapitalStock", 
	a."IssuanceOfDebt", 
	a."LandAndImprovements", 
	a."Leases", 
	a."LiabilitiesHeldforSaleNonCurrent", 
	a."LimitedPartnershipCapital", 
	a."LineOfCredit", 
	a."LoansReceivable", 
	a."LongTermCapitalLeaseObligation", 
	a."LongTermDebt", 
	a."LongTermDebtAndCapitalLeaseObligation", 
	a."LongTermDebtIssuance", 
	a."LongTermDebtPayments", 
	a."LongTermEquityInvestment", 
	a."LongTermProvisions", 
	a."MachineryFurnitureEquipment", 
	a."MarketCap", 
	a."MinimumPensionLiabilities", 
	a."MinorityInterest", 
	a."MinorityInterests", 
	a."NetBusinessPurchaseAndSale", 
	a."NetCommonStockIssuance", 
	a."NetDebt", 
	a."NetForeignCurrencyExchangeGainLoss", 
	a."NetIncome", 
	a."NetIncomeCommonStockholders", 
	a."NetIncomeContinuousOperations", 
	a."NetIncomeDiscontinuousOperations", 
	a."NetIncomeExtraordinary", 
	a."NetIncomeFromContinuingAndDiscontinuedOperation", 
	a."NetIncomeFromContinuingOperationNetMinorityInterest", 
	a."NetIncomeFromContinuingOperations", 
	a."NetIncomeFromTaxLossCarryforward", 
	a."NetIncomeIncludingNoncontrollingInterests", 
	a."NetIntangiblesPurchaseAndSale", 
	a."NetInterestIncome", 
	a."NetInvestmentPropertiesPurchaseAndSale", 
	a."NetInvestmentPurchaseAndSale", 
	a."NetIssuancePaymentsOfDebt", 
	a."NetLongTermDebtIssuance", 
	a."NetNonOperatingInterestIncomeExpense", 
	a."NetOtherFinancingCharges", 
	a."NetOtherInvestingChanges", 
	a."NetPPE", 
	a."NetPPEPurchaseAndSale", 
	a."NetPreferredStockIssuance", 
	a."NetShortTermDebtIssuance", 
	a."NetTangibleAssets", 
	a."NonCurrentAccountsReceivable", 
	a."NonCurrentAccruedExpenses", 
	a."NonCurrentDeferredAssets", 
	a."NonCurrentDeferredLiabilities", 
	a."NonCurrentDeferredRevenue", 
	a."NonCurrentDeferredTaxesAssets", 
	a."NonCurrentDeferredTaxesLiabilities", 
	a."NonCurrentNoteReceivables", 
	a."NonCurrentPensionAndOtherPostretirementBenefitPlans", 
	a."NonCurrentPrepaidAssets", 
	a."NormalizedEBITDA", 
	a."NormalizedIncome", 
	a."NotesReceivable", 
	a."OperatingCashFlow", 
	a."OperatingExpense", 
	a."OperatingGainsLosses", 
	a."OperatingIncome", 
	a."OperatingRevenue", 
	a."OrdinarySharesNumber", 
	a."OtherCashAdjustmentInsideChangeinCash", 
	a."OtherCashAdjustmentOutsideChangeinCash", 
	a."OtherCashPaymentsfromOperatingActivities", 
	a."OtherCashReceiptsfromOperatingActivities", 
	a."OtherCurrentAssets", 
	a."OtherCurrentBorrowings", 
	a."OtherCurrentLiabilities", 
	a."OtherEquityAdjustments", 
	a."OtherEquityInterest", 
	a."OtherGandA", 
	a."OtherIncomeExpense", 
	a."OtherIntangibleAssets", 
	a."OtherInventories", 
	a."OtherInvestments", 
	a."OtherNonCashItems", 
	a."OtherNonCurrentAssets", 
	a."OtherNonCurrentLiabilities", 
	a."OtherNonOperatingIncomeExpenses", 
	a."OtherOperatingExpenses", 
	a."OtherPayable", 
	a."OtherProperties", 
	a."OtherReceivables", 
	a."OtherShortTermInvestments", 
	a."OtherSpecialCharges", 
	a."OtherTaxes", 
	a."OtherunderPreferredStockDividend", 
	a."Payables", 
	a."PayablesAndAccruedExpenses", 
	a."PaymentsonBehalfofEmployees", 
	a."PensionAndEmployeeBenefitExpense", 
	a."PensionandOtherPostRetirementBenefitPlansCurrent", 
	a."PreferredSecuritiesOutsideStockEquity", 
	a."PreferredSharesNumber", 
	a."PreferredStock", 
	a."PreferredStockDividendPaid", 
	a."PreferredStockDividends", 
	a."PreferredStockEquity", 
	a."PreferredStockIssuance", 
	a."PreferredStockPayments", 
	a."PrepaidAssets", 
	a."PretaxIncome", 
	a."ProceedsFromStockOptionExercised", 
	a."Properties", 
	a."ProvisionForDoubtfulAccounts", 
	a."ProvisionandWriteOffofAssets", 
	a."PurchaseOfBusiness", 
	a."PurchaseOfIntangibles", 
	a."PurchaseOfInvestment", 
	a."PurchaseOfInvestmentProperties", 
	a."PurchaseOfPPE", 
	a."RawMaterials", 
	a."Receivables", 
	a."ReceivablesAdjustmentsAllowances", 
	a."ReconciledCostOfRevenue", 
	a."ReconciledDepreciation", 
	a."RentAndLandingFees", 
	a."RentExpenseSupplemental", 
	a."RepaymentOfDebt", 
	a."RepurchaseOfCapitalStock", 
	a."ResearchAndDevelopment", 
	a."RestrictedCash", 
	a."RestructuringAndMergernAcquisition", 
	a."RetainedEarnings", 
	a."SalariesAndWages", 
	a."SaleOfBusiness", 
	a."SaleOfIntangibles", 
	a."SaleOfInvestment", 
	a."SaleOfInvestmentProperties", 
	a."SaleOfPPE", 
	a."SecuritiesAmortization", 
	a."SellingAndMarketingExpense", 
	a."SellingGeneralAndAdministration", 
	a."ShareIssued", 
	a."ShortTermDebtIssuance", 
	a."ShortTermDebtPayments", 
	a."SpecialIncomeCharges", 
	a."StockBasedCompensation", 
	a."StockholdersEquity", 
	a."TangibleBookValue", 
	a."TaxEffectOfUnusualItems", 
	a."TaxProvision", 
	a."TaxRateForCalcs", 
	a."TaxesReceivable", 
	a."TaxesRefundPaid", 
	a."TotalAssets", 
	a."TotalCapitalization", 
	a."TotalDebt", 
	a."TotalEquityGrossMinorityInterest", 
	a."TotalExpenses", 
	a."TotalLiabilitiesNetMinorityInterest", 
	a."TotalNonCurrentAssets", 
	a."TotalNonCurrentLiabilitiesNetMinorityInterest", 
	a."TotalOperatingIncomeAsReported", 
	a."TotalOtherFinanceCost", 
	a."TotalPartnershipCapital", 
	a."TotalRevenue", 
	a."TotalTaxPayable", 
	a."TotalUnusualItems", 
	a."TotalUnusualItemsExcludingGoodwill", 
	a."TradeandOtherPayablesNonCurrent", 
	a."TradingSecurities", 
	a."TreasurySharesNumber", 
	a."TreasuryStock", 
	a."UnrealizedGainLoss", 
	a."UnrealizedGainLossOnInvestmentSecurities", 
	a."WorkInProcess", 
	a."WorkingCapital", 
	a."WriteOff", 
	a."InterestPaidDirect", 
	a."InterestReceivedDirect", 
	a."PaymentstoSuppliersforGoodsandServices", 
	a."ReceiptsfromCustomers", 
	a."RestrictedCommonStock", 
	a."TaxesRefundPaidDirect", 
	a."KeyStats_maxAge", 
	a."KeyStats_priceHint", 
	a."KeyStats_enterpriseValue", 
	a."KeyStats_forwardPE", 
	a."KeyStats_profitMargins", 
	a."KeyStats_floatShares", 
	a."KeyStats_sharesOutstanding", 
	a."KeyStats_sharesShort", 
	a."KeyStats_sharesShortPriorMonth", 
	a."KeyStats_sharesShortPreviousMonthDate", 
	a."KeyStats_dateShortInterest", 
	a."KeyStats_sharesPercentSharesOut", 
	a."KeyStats_heldPercentInsiders", 
	a."KeyStats_heldPercentInstitutions", 
	a."KeyStats_shortRatio", 
	a."KeyStats_shortPercentOfFloat", 
	a."KeyStats_beta", 
	a."KeyStats_impliedSharesOutstanding", 
	a."KeyStats_category", 
	a."KeyStats_bookValue", 
	a."KeyStats_priceToBook", 
	a."KeyStats_fundFamily", 
	a."KeyStats_legalType", 
	a."KeyStats_lastFiscalYearEnd", 
	a."KeyStats_nextFiscalYearEnd", 
	a."KeyStats_mostRecentQuarter", 
	a."KeyStats_earningsQuarterlyGrowth", 
	a."KeyStats_netIncomeToCommon", 
	a."KeyStats_trailingEps", 
	a."KeyStats_forwardEps", 
	a."KeyStats_lastSplitFactor", 
	a."KeyStats_lastSplitDate", 
	a."KeyStats_enterpriseToRevenue", 
	a."KeyStats_enterpriseToEbitda", 
	a."KeyStats_52WeekChange", 
	a."KeyStats_SandP52WeekChange", 
	a."KeyStats_lastDividendValue", 
	a."KeyStats_lastDividendDate", 
	a."KeyStats_latestShareClass", 
	a."KeyStats_leadInvestor", 
	a."Forward_EPS_Growth_Percent", 
	a."Summary_maxAge", 
	a."Summary_priceHint", 
	a."Summary_previousClose", 
	a."Summary_open", 
	a."Summary_dayLow", 
	a."Summary_dayHigh", 
	a."Summary_regularMarketPreviousClose", 
	a."Summary_regularMarketOpen", 
	a."Summary_regularMarketDayLow", 
	a."Summary_regularMarketDayHigh", 
	a."Summary_dividendRate", 
	a."Summary_dividendYield", 
	a."Summary_exDividendDate", 
	a."Summary_payoutRatio", 
	a."Summary_fiveYearAvgDividendYield", 
	a."Summary_beta", 
	a."Summary_trailingPE", 
	a."Summary_forwardPE", 
	a."Summary_volume", 
	a."Summary_regularMarketVolume", 
	a."Summary_averageVolume", 
	a."Summary_averageVolume10days", 
	a."Summary_averageDailyVolume10Day", 
	a."Summary_bid", 
	a."Summary_ask", 
	a."Summary_bidSize", 
	a."Summary_askSize", 
	a."Summary_marketCap", 
	a."Summary_fiftyTwoWeekLow", 
	a."Summary_fiftyTwoWeekHigh", 
	a."Summary_allTimeHigh", 
	a."Summary_allTimeLow", 
	a."Summary_priceToSalesTrailing12Months", 
	a."Summary_fiftyDayAverage", 
	a."Summary_twoHundredDayAverage", 
	a."Summary_trailingAnnualDividendRate", 
	a."Summary_trailingAnnualDividendYield", 
	a."Summary_currency", 
	a."Summary_fromCurrency", 
	a."Summary_toCurrency", 
	a."Summary_lastMarket", 
	a."Summary_coinMarketCapLink", 
	a."Summary_algorithm", 
	a."Summary_tradeable", 
	a."FinData_maxAge", 
	a."FinData_currentPrice", 
	a."FinData_targetHighPrice", 
	a."FinData_targetLowPrice", 
	a."FinData_targetMeanPrice", 
	a."FinData_targetMedianPrice", 
	a."FinData_recommendationMean", 
	a."FinData_recommendationKey", 
	a."FinData_numberOfAnalystOpinions", 
	a."FinData_totalCash", 
	a."FinData_totalCashPerShare", 
	a."FinData_ebitda", 
	a."FinData_totalDebt", 
	a."FinData_quickRatio", 
	a."FinData_currentRatio", 
	a."FinData_totalRevenue", 
	a."FinData_debtToEquity", 
	a."FinData_revenuePerShare", 
	a."FinData_returnOnAssets", 
	a."FinData_returnOnEquity", 
	a."FinData_grossProfits", 
	a."FinData_freeCashflow", 
	a."FinData_operatingCashflow", 
	a."FinData_earningsGrowth", 
	a."FinData_revenueGrowth", 
	a."FinData_grossMargins", 
	a."FinData_ebitdaMargins", 
	a."FinData_operatingMargins", 
	a."FinData_profitMargins", 
	a."FinData_financialCurrency", 
	a."KeyStats_ytdReturn", 
	a."KeyStats_beta3Year", 
	a."KeyStats_totalAssets", 
	a."KeyStats_yield", 
	a."KeyStats_fundInceptionDate", 
	a."KeyStats_threeYearAverageReturn", 
	a."KeyStats_fiveYearAverageReturn", 
	a."Summary_yield", 
	a."Summary_totalAssets", 
	a."Summary_navPrice",

	-- FundamentalDataDividendRadar
	CASE WHEN b.symbol IS NOT NULL THEN TRUE ELSE FALSE END as has_fundamental_data_dividend_radar,
	b."Company", 
	b."FV", 
	b."Sector", 
	b."No-Years", 
	b."Price", 
	b."Div-Yield", 
	b."5Y-Avg-Yield", 
	b."Current-Div", 
	b."Payouts/-Year", 
	b."Annualized", 
	b."Previous-Div", 
	b."Ex-Date", 
	b."Pay-Date", 
	b."Low", 
	b."High", 
	b."DGR-1Y", 
	b."DGR-3Y", 
	b."DGR-5Y", 
	b."DGR-10Y", 
	b."TTR-1Y", 
	b."TTR-3Y", 
	b."Fair-Value", 
	b."FV-%", 
	b."Streak-Basis", 
	b."Chowder-Number", 
	b."EPS-1Y", 
	b."Revenue-1Y", 
	b."NPM", 
	b."CF/Share", 
	b."ROE", 
	b."Current-R", 
	b."Debt/Capital", 
	b."ROTC", 
	b."P/E", 
	b."P/BV", 
	b."PEG", 
	b."New-Member", 
	b."Industry", 
	b."Classification"

FROM 
    FundamentalDataYahoo as a
LEFT OUTER JOIN 
    FundamentalDataDividendRadar AS b
ON a.symbol = b.symbol;

DROP VIEW IF EXISTS OptionDataMerged;
CREATE VIEW OptionDataMerged AS
SELECT 
	-- Option Data
    a.symbol, 
	a.has_option_data_tradingview,
	a.has_option_pricing_metrics,
	a."option-type", 
	a.strike, 
	a.expiration_date, 
	a.days_to_expiration,
    a.ask, 
	a.bid, 
	a.delta, 
	a.gamma, 
	a.iv, 
	a.rho, 
    a."theoPrice", 
	a.theta, 
	a.vega, 
	a.option, 
	a.time, 
	a.exchange, 
	a.option_osi,
    a."contractSymbol",  
	a.currency, 
	a."lastPrice", 
	a.change, 
	a."percentChange", 
	a.option_open_interest, 
	a."contractSize", 
	a."lastTradeDate", 
	a."impliedVolatility", 
	a."inTheMoney", 
	a.option_volume,
	a.premium_option_price,
	a.spread,
    a.spread_ptc,
	a.intrinsic_value,
	a.extrinsic_value,
	a.strike_stock_price_difference,
    a.strike_stock_price_difference_ptc,

    -- Fundamental Data
	b.has_fundamental_data_dividend_radar,
	b."Company", 
	b."FV", 
	b."Sector", 
	b."No-Years", 
	b."Price", 
	b."Div-Yield", 
	b."5Y-Avg-Yield", 
	b."Current-Div", 
	b."Payouts/-Year", 
	b."Annualized", 
	b."Previous-Div", 
	b."Ex-Date", 
	b."Pay-Date", 
	b."Low", 
	b."High", 
	b."DGR-1Y", 
	b."DGR-3Y", 
	b."DGR-5Y", 
	b."DGR-10Y", 
	b."TTR-1Y", 
	b."TTR-3Y", 
	b."Fair-Value", 
	b."FV-%", 
	b."Streak-Basis", 
	b."Chowder-Number", 
	b."EPS-1Y", 
	b."Revenue-1Y", 
	b."NPM", 
	b."CF/Share", 
	b."ROE", 
	b."Current-R", 
	b."Debt/Capital", 
	b."ROTC", 
	b."P/E", 
	b."P/BV", 
	b."PEG", 
	b."New-Member", 
	b."Industry", 
	b."Classification",
    b."asOfDate", 
	b."periodType", 
	b."currencyCode", 
	b."AccountsPayable", 
	b."AccountsReceivable", 
	b."AccruedInterestReceivable", 
	b."AccumulatedDepreciation", 
	b."AdditionalPaidInCapital", 
	b."AllowanceForDoubtfulAccountsReceivable", 
	b."Amortization", 
	b."AmortizationCashFlow", 
	b."AmortizationOfIntangibles", 
	b."AmortizationOfIntangiblesIncomeStatement", 
	b."AmortizationOfSecurities", 
	b."AssetImpairmentCharge", 
	b."AssetsHeldForSaleCurrent", 
	b."AvailableForSaleSecurities", 
	b."AverageDilutionEarnings", 
	b."BasicAverageShares", 
	b."BasicEPS", 
	b."BeginningCashPosition", 
	b."BuildingsAndImprovements", 
	b."CapitalExpenditure", 
	b."CapitalExpenditureReported", 
	b."CapitalLeaseObligations", 
	b."CapitalStock", 
	b."CashAndCashEquivalents", 
	b."CashCashEquivalentsAndShortTermInvestments", 
	b."CashDividendsPaid", 
	b."CashEquivalents", 
	b."CashFinancial", 
	b."CashFlowFromContinuingFinancingActivities", 
	b."CashFlowFromContinuingInvestingActivities", 
	b."CashFlowFromContinuingOperatingActivities", 
	b."CashFlowFromDiscontinuedOperation", 
	b."CashFlowsfromusedinOperatingActivitiesDirect", 
	b."CashFromDiscontinuedFinancingActivities", 
	b."CashFromDiscontinuedInvestingActivities", 
	b."CashFromDiscontinuedOperatingActivities", 
	b."ChangeInAccountPayable", 
	b."ChangeInAccruedExpense", 
	b."ChangeInCashSupplementalAsReported", 
	b."ChangeInDividendPayable", 
	b."ChangeInIncomeTaxPayable", 
	b."ChangeInInterestPayable", 
	b."ChangeInInventory", 
	b."ChangeInOtherCurrentAssets", 
	b."ChangeInOtherCurrentLiabilities", 
	b."ChangeInOtherWorkingCapital", 
	b."ChangeInPayable", 
	b."ChangeInPayablesAndAccruedExpense", 
	b."ChangeInPrepaidAssets", 
	b."ChangeInReceivables", 
	b."ChangeInTaxPayable", 
	b."ChangeInWorkingCapital", 
	b."ChangesInAccountReceivables", 
	b."ChangesInCash", 
	b."ClassesofCashPayments", 
	b."ClassesofCashReceiptsfromOperatingActivities", 
	b."CommercialPaper", 
	b."CommonStock", 
	b."CommonStockDividendPaid", 
	b."CommonStockEquity", 
	b."CommonStockIssuance", 
	b."CommonStockPayments", 
	b."ConstructionInProgress", 
	b."CostOfRevenue", 
	b."CurrentAccruedExpenses", 
	b."CurrentAssets", 
	b."CurrentCapitalLeaseObligation", 
	b."CurrentDebt", 
	b."CurrentDebtAndCapitalLeaseObligation", 
	b."CurrentDeferredAssets", 
	b."CurrentDeferredLiabilities", 
	b."CurrentDeferredRevenue", 
	b."CurrentDeferredTaxesAssets", 
	b."CurrentDeferredTaxesLiabilities", 
	b."CurrentLiabilities", 
	b."CurrentNotesPayable", 
	b."CurrentProvisions", 
	b."DeferredIncomeTax", 
	b."DeferredTax", 
	b."DefinedPensionBenefit", 
	b."Depletion", 
	b."DepletionIncomeStatement", 
	b."Depreciation", 
	b."DepreciationAmortizationDepletion", 
	b."DepreciationAmortizationDepletionIncomeStatement", 
	b."DepreciationAndAmortization", 
	b."DepreciationAndAmortizationInIncomeStatement", 
	b."DepreciationIncomeStatement", 
	b."DerivativeProductLiabilities", 
	b."DilutedAverageShares", 
	b."DilutedEPS", 
	b."DilutedNIAvailtoComStockholders", 
	b."DividendPaidCFO", 
	b."DividendReceivedCFO", 
	b."DividendsPayable", 
	b."DividendsReceivedCFI", 
	b."DuefromRelatedPartiesCurrent", 
	b."DuefromRelatedPartiesNonCurrent", 
	b."DuetoRelatedPartiesCurrent", 
	b."DuetoRelatedPartiesNonCurrent", 
	b."EBIT", 
	b."EBITDA", 
	b."EarningsFromEquityInterest", 
	b."EarningsFromEquityInterestNetOfTax", 
	b."EarningsLossesFromEquityInvestments", 
	b."EffectOfExchangeRateChanges", 
	b."EmployeeBenefits", 
	b."EndCashPosition", 
	b."EnterpriseValue", 
	b."EnterprisesValueEBITDARatio", 
	b."EnterprisesValueRevenueRatio", 
	b."ExcessTaxBenefitFromStockBasedCompensation", 
	b."ExciseTaxes", 
	b."FinancialAssets", 
	b."FinancialAssetsDesignatedasFairValueThroughProfitorLossTotal", 
	b."FinancingCashFlow", 
	b."FinishedGoods", 
	b."FixedAssetsRevaluationReserve", 
	b."ForeignCurrencyTranslationAdjustments", 
	b."FreeCashFlow", 
	b."GainLossOnInvestmentSecurities", 
	b."GainLossOnSaleOfBusiness", 
	b."GainLossOnSaleOfPPE", 
	b."GainOnSaleOfBusiness", 
	b."GainOnSaleOfPPE", 
	b."GainOnSaleOfSecurity", 
	b."GainsLossesNotAffectingRetainedEarnings", 
	b."GeneralAndAdministrativeExpense", 
	b."GeneralPartnershipCapital", 
	b."Goodwill", 
	b."GoodwillAndOtherIntangibleAssets", 
	b."GrossAccountsReceivable", 
	b."GrossPPE", 
	b."GrossProfit", 
	b."HedgingAssetsCurrent", 
	b."HeldToMaturitySecurities", 
	b."ImpairmentOfCapitalAssets", 
	b."IncomeTaxPaidSupplementalData", 
	b."IncomeTaxPayable", 
	b."InsuranceAndClaims", 
	b."InterestExpense", 
	b."InterestExpenseNonOperating", 
	b."InterestIncome", 
	b."InterestIncomeNonOperating", 
	b."InterestPaidCFF", 
	b."InterestPaidCFO", 
	b."InterestPaidSupplementalData", 
	b."InterestPayable", 
	b."InterestReceivedCFI", 
	b."InterestReceivedCFO", 
	b."InventoriesAdjustmentsAllowances", 
	b."Inventory", 
	b."InvestedCapital", 
	b."InvestingCashFlow", 
	b."InvestmentProperties", 
	b."InvestmentinFinancialAssets", 
	b."InvestmentsAndAdvances", 
	b."InvestmentsInOtherVenturesUnderEquityMethod", 
	b."InvestmentsinAssociatesatCost", 
	b."InvestmentsinJointVenturesatCost", 
	b."InvestmentsinSubsidiariesatCost", 
	b."IssuanceOfCapitalStock", 
	b."IssuanceOfDebt", 
	b."LandAndImprovements", 
	b."Leases", 
	b."LiabilitiesHeldforSaleNonCurrent", 
	b."LimitedPartnershipCapital", 
	b."LineOfCredit", 
	b."LoansReceivable", 
	b."LongTermCapitalLeaseObligation", 
	b."LongTermDebt", 
	b."LongTermDebtAndCapitalLeaseObligation", 
	b."LongTermDebtIssuance", 
	b."LongTermDebtPayments", 
	b."LongTermEquityInvestment", 
	b."LongTermProvisions", 
	b."MachineryFurnitureEquipment", 
	b."MarketCap", 
	b."MinimumPensionLiabilities", 
	b."MinorityInterest", 
	b."MinorityInterests", 
	b."NetBusinessPurchaseAndSale", 
	b."NetCommonStockIssuance", 
	b."NetDebt", 
	b."NetForeignCurrencyExchangeGainLoss", 
	b."NetIncome", 
	b."NetIncomeCommonStockholders", 
	b."NetIncomeContinuousOperations", 
	b."NetIncomeDiscontinuousOperations", 
	b."NetIncomeExtraordinary", 
	b."NetIncomeFromContinuingAndDiscontinuedOperation", 
	b."NetIncomeFromContinuingOperationNetMinorityInterest", 
	b."NetIncomeFromContinuingOperations", 
	b."NetIncomeFromTaxLossCarryforward", 
	b."NetIncomeIncludingNoncontrollingInterests", 
	b."NetIntangiblesPurchaseAndSale", 
	b."NetInterestIncome", 
	b."NetInvestmentPropertiesPurchaseAndSale", 
	b."NetInvestmentPurchaseAndSale", 
	b."NetIssuancePaymentsOfDebt", 
	b."NetLongTermDebtIssuance", 
	b."NetNonOperatingInterestIncomeExpense", 
	b."NetOtherFinancingCharges", 
	b."NetOtherInvestingChanges", 
	b."NetPPE", 
	b."NetPPEPurchaseAndSale", 
	b."NetPreferredStockIssuance", 
	b."NetShortTermDebtIssuance", 
	b."NetTangibleAssets", 
	b."NonCurrentAccountsReceivable", 
	b."NonCurrentAccruedExpenses", 
	b."NonCurrentDeferredAssets", 
	b."NonCurrentDeferredLiabilities", 
	b."NonCurrentDeferredRevenue", 
	b."NonCurrentDeferredTaxesAssets", 
	b."NonCurrentDeferredTaxesLiabilities", 
	b."NonCurrentNoteReceivables", 
	b."NonCurrentPensionAndOtherPostretirementBenefitPlans", 
	b."NonCurrentPrepaidAssets", 
	b."NormalizedEBITDA", 
	b."NormalizedIncome", 
	b."NotesReceivable", 
	b."OperatingCashFlow", 
	b."OperatingExpense", 
	b."OperatingGainsLosses", 
	b."OperatingIncome", 
	b."OperatingRevenue", 
	b."OrdinarySharesNumber", 
	b."OtherCashAdjustmentInsideChangeinCash", 
	b."OtherCashAdjustmentOutsideChangeinCash", 
	b."OtherCashPaymentsfromOperatingActivities", 
	b."OtherCashReceiptsfromOperatingActivities", 
	b."OtherCurrentAssets", 
	b."OtherCurrentBorrowings", 
	b."OtherCurrentLiabilities", 
	b."OtherEquityAdjustments", 
	b."OtherEquityInterest", 
	b."OtherGandA", 
	b."OtherIncomeExpense", 
	b."OtherIntangibleAssets", 
	b."OtherInventories", 
	b."OtherInvestments", 
	b."OtherNonCashItems", 
	b."OtherNonCurrentAssets", 
	b."OtherNonCurrentLiabilities", 
	b."OtherNonOperatingIncomeExpenses", 
	b."OtherOperatingExpenses", 
	b."OtherPayable", 
	b."OtherProperties", 
	b."OtherReceivables", 
	b."OtherShortTermInvestments", 
	b."OtherSpecialCharges", 
	b."OtherTaxes", 
	b."OtherunderPreferredStockDividend", 
	b."Payables", 
	b."PayablesAndAccruedExpenses", 
	b."PaymentsonBehalfofEmployees", 
	b."PensionAndEmployeeBenefitExpense", 
	b."PensionandOtherPostRetirementBenefitPlansCurrent", 
	b."PreferredSecuritiesOutsideStockEquity", 
	b."PreferredSharesNumber", 
	b."PreferredStock", 
	b."PreferredStockDividendPaid", 
	b."PreferredStockDividends", 
	b."PreferredStockEquity", 
	b."PreferredStockIssuance", 
	b."PreferredStockPayments", 
	b."PrepaidAssets", 
	b."PretaxIncome", 
	b."ProceedsFromStockOptionExercised", 
	b."Properties", 
	b."ProvisionForDoubtfulAccounts", 
	b."ProvisionandWriteOffofAssets", 
	b."PurchaseOfBusiness", 
	b."PurchaseOfIntangibles", 
	b."PurchaseOfInvestment", 
	b."PurchaseOfInvestmentProperties", 
	b."PurchaseOfPPE", 
	b."RawMaterials", 
	b."Receivables", 
	b."ReceivablesAdjustmentsAllowances", 
	b."ReconciledCostOfRevenue", 
	b."ReconciledDepreciation", 
	b."RentAndLandingFees", 
	b."RentExpenseSupplemental", 
	b."RepaymentOfDebt", 
	b."RepurchaseOfCapitalStock", 
	b."ResearchAndDevelopment", 
	b."RestrictedCash", 
	b."RestructuringAndMergernAcquisition", 
	b."RetainedEarnings", 
	b."SalariesAndWages", 
	b."SaleOfBusiness", 
	b."SaleOfIntangibles", 
	b."SaleOfInvestment", 
	b."SaleOfInvestmentProperties", 
	b."SaleOfPPE", 
	b."SecuritiesAmortization", 
	b."SellingAndMarketingExpense", 
	b."SellingGeneralAndAdministration", 
	b."ShareIssued", 
	b."ShortTermDebtIssuance", 
	b."ShortTermDebtPayments", 
	b."SpecialIncomeCharges", 
	b."StockBasedCompensation", 
	b."StockholdersEquity", 
	b."TangibleBookValue", 
	b."TaxEffectOfUnusualItems", 
	b."TaxProvision", 
	b."TaxRateForCalcs", 
	b."TaxesReceivable", 
	b."TaxesRefundPaid", 
	b."TotalAssets", 
	b."TotalCapitalization", 
	b."TotalDebt", 
	b."TotalEquityGrossMinorityInterest", 
	b."TotalExpenses", 
	b."TotalLiabilitiesNetMinorityInterest", 
	b."TotalNonCurrentAssets", 
	b."TotalNonCurrentLiabilitiesNetMinorityInterest", 
	b."TotalOperatingIncomeAsReported", 
	b."TotalOtherFinanceCost", 
	b."TotalPartnershipCapital", 
	b."TotalRevenue", 
	b."TotalTaxPayable", 
	b."TotalUnusualItems", 
	b."TotalUnusualItemsExcludingGoodwill", 
	b."TradeandOtherPayablesNonCurrent", 
	b."TradingSecurities", 
	b."TreasurySharesNumber", 
	b."TreasuryStock", 
	b."UnrealizedGainLoss", 
	b."UnrealizedGainLossOnInvestmentSecurities", 
	b."WorkInProcess", 
	b."WorkingCapital", 
	b."WriteOff", 
	b."InterestPaidDirect", 
	b."InterestReceivedDirect", 
	b."PaymentstoSuppliersforGoodsandServices", 
	b."ReceiptsfromCustomers", 
	b."RestrictedCommonStock", 
	b."TaxesRefundPaidDirect", 
	b."KeyStats_maxAge", 
	b."KeyStats_priceHint", 
	b."KeyStats_enterpriseValue", 
	b."KeyStats_forwardPE", 
	b."KeyStats_profitMargins", 
	b."KeyStats_floatShares", 
	b."KeyStats_sharesOutstanding", 
	b."KeyStats_sharesShort", 
	b."KeyStats_sharesShortPriorMonth", 
	b."KeyStats_sharesShortPreviousMonthDate", 
	b."KeyStats_dateShortInterest", 
	b."KeyStats_sharesPercentSharesOut", 
	b."KeyStats_heldPercentInsiders", 
	b."KeyStats_heldPercentInstitutions", 
	b."KeyStats_shortRatio", 
	b."KeyStats_shortPercentOfFloat", 
	b."KeyStats_beta", 
	b."KeyStats_impliedSharesOutstanding", 
	b."KeyStats_category", 
	b."KeyStats_bookValue", 
	b."KeyStats_priceToBook", 
	b."KeyStats_fundFamily", 
	b."KeyStats_legalType", 
	b."KeyStats_lastFiscalYearEnd", 
	b."KeyStats_nextFiscalYearEnd", 
	b."KeyStats_mostRecentQuarter", 
	b."KeyStats_earningsQuarterlyGrowth", 
	b."KeyStats_netIncomeToCommon", 
	b."KeyStats_trailingEps", 
	b."KeyStats_forwardEps", 
	b."KeyStats_lastSplitFactor", 
	b."KeyStats_lastSplitDate", 
	b."KeyStats_enterpriseToRevenue", 
	b."KeyStats_enterpriseToEbitda", 
	b."KeyStats_52WeekChange", 
	b."KeyStats_SandP52WeekChange", 
	b."KeyStats_lastDividendValue", 
	b."KeyStats_lastDividendDate", 
	b."KeyStats_latestShareClass", 
	b."KeyStats_leadInvestor", 
	b."Forward_EPS_Growth_Percent", 
	b."Summary_maxAge", 
	b."Summary_priceHint", 
	b."Summary_previousClose", 
	b."Summary_open", 
	b."Summary_dayLow", 
	b."Summary_dayHigh", 
	b."Summary_regularMarketPreviousClose", 
	b."Summary_regularMarketOpen", 
	b."Summary_regularMarketDayLow", 
	b."Summary_regularMarketDayHigh", 
	b."Summary_dividendRate", 
	b."Summary_dividendYield", 
	b."Summary_exDividendDate", 
	b."Summary_payoutRatio", 
	b."Summary_fiveYearAvgDividendYield", 
	b."Summary_beta", 
	b."Summary_trailingPE", 
	b."Summary_forwardPE", 
	b."Summary_volume", 
	b."Summary_regularMarketVolume", 
	b."Summary_averageVolume", 
	b."Summary_averageVolume10days", 
	b."Summary_averageDailyVolume10Day", 
	b."Summary_bid", 
	b."Summary_ask", 
	b."Summary_bidSize", 
	b."Summary_askSize", 
	b."Summary_marketCap", 
	b."Summary_fiftyTwoWeekLow", 
	b."Summary_fiftyTwoWeekHigh", 
	b."Summary_allTimeHigh", 
	b."Summary_allTimeLow", 
	b."Summary_priceToSalesTrailing12Months", 
	b."Summary_fiftyDayAverage", 
	b."Summary_twoHundredDayAverage", 
	b."Summary_trailingAnnualDividendRate", 
	b."Summary_trailingAnnualDividendYield", 
	b."Summary_currency", 
	b."Summary_fromCurrency", 
	b."Summary_toCurrency", 
	b."Summary_lastMarket", 
	b."Summary_coinMarketCapLink", 
	b."Summary_algorithm", 
	b."Summary_tradeable", 
	b."FinData_maxAge", 
	b."FinData_currentPrice", 
	b."FinData_targetHighPrice", 
	b."FinData_targetLowPrice", 
	b."FinData_targetMeanPrice", 
	b."FinData_targetMedianPrice", 
	b."FinData_recommendationMean", 
	b."FinData_recommendationKey", 
	b."FinData_numberOfAnalystOpinions", 
	b."FinData_totalCash", 
	b."FinData_totalCashPerShare", 
	b."FinData_ebitda", 
	b."FinData_totalDebt", 
	b."FinData_quickRatio", 
	b."FinData_currentRatio", 
	b."FinData_totalRevenue", 
	b."FinData_debtToEquity", 
	b."FinData_revenuePerShare", 
	b."FinData_returnOnAssets", 
	b."FinData_returnOnEquity", 
	b."FinData_grossProfits", 
	b."FinData_freeCashflow", 
	b."FinData_operatingCashflow", 
	b."FinData_earningsGrowth", 
	b."FinData_revenueGrowth", 
	b."FinData_grossMargins", 
	b."FinData_ebitdaMargins", 
	b."FinData_operatingMargins", 
	b."FinData_profitMargins", 
	b."FinData_financialCurrency", 
	b."KeyStats_ytdReturn", 
	b."KeyStats_beta3Year", 
	b."KeyStats_totalAssets", 
	b."KeyStats_yield", 
	b."KeyStats_fundInceptionDate", 
	b."KeyStats_threeYearAverageReturn", 
	b."KeyStats_fiveYearAverageReturn", 
	b."Summary_yield", 
	b."Summary_totalAssets", 
	b."Summary_navPrice",

    -- Stock Data
	CASE WHEN c.symbol IS NOT NULL THEN TRUE ELSE FALSE END as has_stock_data,
	c.has_earnings_date,
	c.has_analyst_price_target,
	c.live_stock_price,
    c.price_source,
    c.live_price_timestamp,
    c.earnings_date,
	c.days_to_ernings,
    c.analyst_mean_target,

    -- Technical Indicators
	CASE WHEN d.symbol IS NOT NULL THEN TRUE ELSE FALSE END as has_technical_indicators,
    d."Recommend.Other", 
	d."Recommend.All", 
	d."Recommend.MA", 
	d."RSI", 
	d."RSI[1]", 
	d."Stoch.K", 
	d."Stoch.D", 
	d."Stoch.K[1]", 
	d."Stoch.D[1]", 
	d."CCI20", 
	d."CCI20[1]", 
	d."ADX", 
	d."ADX+DI", 
	d."ADX-DI", 
	d."ADX+DI[1]", 
	d."ADX-DI[1]", 
	d."AO", 
	d."AO[1]", 
	d."Mom", 
	d."Mom[1]", 
	d."MACD.macd", 
	d."MACD.signal", 
	d."Rec.Stoch.RSI", 
	d."Stoch.RSI.K", 
	d."Rec.WR", 
	d."W.R", 
	d."Rec.BBPower", 
	d."BBPower", 
	d."Rec.UO", 
	d."UO", 
	d.close, 
	d."EMA5", 
	d."SMA5", 
	d."EMA10", 
	d."SMA10", 
	d."EMA20", 
	d."SMA20", 
	d."EMA30", 
	d."SMA30", 
	d."EMA50", 
	d."SMA50", 
	d."EMA100", 
	d."SMA100", 
	d."EMA200", 
	d."SMA200", 
	d."Rec.Ichimoku", 
	d."Ichimoku.BLine", 
	d."Rec.VWMA", 
	d."VWMA", 
	d."Rec.HullMA9", 
	d."HullMA9", 
	d."Pivot.M.Classic.S3", 
	d."Pivot.M.Classic.S2", 
	d."Pivot.M.Classic.S1", 
	d."Pivot.M.Classic.Middle", 
	d."Pivot.M.Classic.R1", 
	d."Pivot.M.Classic.R2", 
	d."Pivot.M.Classic.R3", 
	d."Pivot.M.Fibonacci.S3", 
	d."Pivot.M.Fibonacci.S2", 
	d."Pivot.M.Fibonacci.S1", 
	d."Pivot.M.Fibonacci.Middle", 
	d."Pivot.M.Fibonacci.R1", 
	d."Pivot.M.Fibonacci.R2", 
	d."Pivot.M.Fibonacci.R3", 
	d."Pivot.M.Camarilla.S3", 
	d."Pivot.M.Camarilla.S2", 
	d."Pivot.M.Camarilla.S1", 
	d."Pivot.M.Camarilla.Middle", 
	d."Pivot.M.Camarilla.R1", 
	d."Pivot.M.Camarilla.R2", 
	d."Pivot.M.Camarilla.R3", 
	d."Pivot.M.Woodie.S3", 
	d."Pivot.M.Woodie.S2", 
	d."Pivot.M.Woodie.S1", 
	d."Pivot.M.Woodie.Middle", 
	d."Pivot.M.Woodie.R1", 
	d."Pivot.M.Woodie.R2", 
	d."Pivot.M.Woodie.R3", 
	d."Pivot.M.Demark.S1", 
	d."Pivot.M.Demark.Middle", 
	d."Pivot.M.Demark.R1", 
	d.open, 
	d."P.SAR", 
	d."BB.lower", 
	d."BB.upper", 
	d."AO[2]", 
	d.volume, 
	d.change, 
	d.low, 
	d.high, 
	d.recommendation, 
	d.recommendation_buy_amount, 
	d.recommendation_neutral_amount, 
	d.recommendation_sell_amount,

	-- Additional calculated fields
	ROUND(c.analyst_mean_target - d.close,2) as "target-close$",
	ROUND(ROUND(c.analyst_mean_target - d.close,2) / d.close * 100, 2) as "target-close%",
	d.close * a.iv * sqrt(a.days_to_expiration / 365) as expected_move

FROM 
    OptionData AS a
JOIN 
    FundamentalData as b
ON a.symbol = b.symbol
LEFT OUTER JOIN 
    StockData as c
ON a.symbol = c.symbol
LEFT OUTER JOIN 
    TechnicalIndicators as d
ON a.symbol = d.symbol;
