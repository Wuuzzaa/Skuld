DROP VIEW IF EXISTS FundamentalData;

CREATE VIEW FundamentalData AS
SELECT 
	-- FundamentalDataYahooProcessed
	a."Symbol",
    a."asOfDate", 
	a."periodType", 
	a."currencyCode", 
	a."AccountsPayable", 
	a."AccountsReceivable", 
	a."AccumulatedDepreciation", 
	a."AvailableForSaleSecurities", 
	a."BasicAverageShares", 
	a."BasicEPS", 
	a."BeginningCashPosition", 
	a."CapitalExpenditure", 
	a."CapitalLeaseObligations", 
	a."CapitalStock", 
	a."CashAndCashEquivalents", 
	a."CashCashEquivalentsAndShortTermInvestments", 
	a."CashDividendsPaid", 
	a."CashEquivalents", 
	a."CashFinancial", 
	a."CashFlowFromContinuingFinancingActivities", 
	a."CashFlowFromContinuingInvestingActivities", 
	a."CashFlowFromContinuingOperatingActivities", 
	a."ChangeInAccountPayable", 
	a."ChangeInCashSupplementalAsReported", 
	a."ChangeInInventory", 
	a."ChangeInOtherCurrentAssets", 
	a."ChangeInOtherCurrentLiabilities", 
	a."ChangeInOtherWorkingCapital", 
	a."ChangeInPayable", 
	a."ChangeInPayablesAndAccruedExpense", 
	a."ChangeInReceivables", 
	a."ChangeInWorkingCapital", 
	a."ChangesInAccountReceivables", 
	a."ChangesInCash", 
	a."CommercialPaper", 
	a."CommonStock", 
	a."CommonStockDividendPaid", 
	a."CommonStockEquity", 
	a."CommonStockIssuance", 
	a."CommonStockPayments", 
	a."CostOfRevenue", 
	a."CurrentAssets", 
	a."CurrentCapitalLeaseObligation", 
	a."CurrentDebt", 
	a."CurrentDebtAndCapitalLeaseObligation", 
	a."CurrentDeferredLiabilities", 
	a."CurrentDeferredRevenue", 
	a."CurrentLiabilities", 
	a."DeferredIncomeTax", 
	a."DeferredTax", 
	a."DepreciationAmortizationDepletion", 
	a."DepreciationAndAmortization", 
	a."DilutedAverageShares", 
	a."DilutedEPS", 
	a."DilutedNIAvailtoComStockholders", 
	a."EBIT", 
	a."EBITDA", 
	a."EndCashPosition", 
	a."EnterpriseValue", 
	a."EnterprisesValueEBITDARatio", 
	a."EnterprisesValueRevenueRatio", 
	a."FinancingCashFlow", 
	a."FreeCashFlow", 
	a."GainsLossesNotAffectingRetainedEarnings", 
	a."GrossPPE", 
	a."GrossProfit", 
	a."IncomeTaxPaidSupplementalData", 
	a."IncomeTaxPayable", 
	a."InterestExpense", 
	a."InterestExpenseNonOperating", 
	a."InterestIncome", 
	a."InterestIncomeNonOperating", 
	a."InterestPaidSupplementalData", 
	a."Inventory", 
	a."InvestedCapital", 
	a."InvestingCashFlow", 
	a."InvestmentinFinancialAssets", 
	a."InvestmentsAndAdvances", 
	a."IssuanceOfCapitalStock", 
	a."IssuanceOfDebt", 
	a."LandAndImprovements", 
	a."Leases", 
	a."LongTermCapitalLeaseObligation", 
	a."LongTermDebt", 
	a."LongTermDebtAndCapitalLeaseObligation", 
	a."LongTermDebtIssuance", 
	a."LongTermDebtPayments", 
	a."MachineryFurnitureEquipment", 
	a."MarketCap", 
	a."NetBusinessPurchaseAndSale", 
	a."NetCommonStockIssuance", 
	a."NetDebt", 
	a."NetIncome", 
	a."NetIncomeCommonStockholders", 
	a."NetIncomeContinuousOperations", 
	a."NetIncomeFromContinuingAndDiscontinuedOperation", 
	a."NetIncomeFromContinuingOperationNetMinorityInterest", 
	a."NetIncomeFromContinuingOperations", 
	a."NetIncomeIncludingNoncontrollingInterests", 
	a."NetInterestIncome", 
	a."NetInvestmentPurchaseAndSale", 
	a."NetIssuancePaymentsOfDebt", 
	a."NetLongTermDebtIssuance", 
	a."NetNonOperatingInterestIncomeExpense", 
	a."NetOtherFinancingCharges", 
	a."NetOtherInvestingChanges", 
	a."NetPPE", 
	a."NetPPEPurchaseAndSale", 
	a."NetShortTermDebtIssuance", 
	a."NetTangibleAssets", 
	a."NonCurrentDeferredAssets", 
	a."NonCurrentDeferredTaxesAssets", 
	a."NormalizedEBITDA", 
	a."NormalizedIncome", 
	a."OperatingCashFlow", 
	a."OperatingExpense", 
	a."OperatingIncome", 
	a."OperatingRevenue", 
	a."OrdinarySharesNumber", 
	a."OtherCurrentAssets", 
	a."OtherCurrentBorrowings", 
	a."OtherCurrentLiabilities", 
	a."OtherEquityAdjustments", 
	a."OtherIncomeExpense", 
	a."OtherInvestments", 
	a."OtherNonCashItems", 
	a."OtherNonCurrentAssets", 
	a."OtherNonCurrentLiabilities", 
	a."OtherNonOperatingIncomeExpenses", 
	a."OtherProperties", 
	a."OtherReceivables", 
	a."OtherShortTermInvestments", 
	a."Payables", 
	a."PayablesAndAccruedExpenses", 
	a."PretaxIncome", 
	a."Properties", 
	a."PurchaseOfBusiness", 
	a."PurchaseOfInvestment", 
	a."PurchaseOfPPE", 
	a."Receivables", 
	a."ReconciledCostOfRevenue", 
	a."ReconciledDepreciation", 
	a."RepaymentOfDebt", 
	a."RepurchaseOfCapitalStock", 
	a."ResearchAndDevelopment", 
	a."RetainedEarnings", 
	a."SaleOfInvestment", 
	a."SellingGeneralAndAdministration", 
	a."ShareIssued", 
	a."StockBasedCompensation", 
	a."StockholdersEquity", 
	a."TangibleBookValue", 
	a."TaxEffectOfUnusualItems", 
	a."TaxProvision", 
	a."TaxRateForCalcs", 
	a."TotalAssets", 
	a."TotalCapitalization", 
	a."TotalDebt", 
	a."TotalEquityGrossMinorityInterest", 
	a."TotalExpenses", 
	a."TotalLiabilitiesNetMinorityInterest", 
	a."TotalNonCurrentAssets", 
	a."TotalNonCurrentLiabilitiesNetMinorityInterest", 
	a."TotalOperatingIncomeAsReported", 
	a."TotalRevenue", 
	a."TotalTaxPayable", 
	a."TradeandOtherPayablesNonCurrent", 
	a."TreasurySharesNumber", 
	a."WorkingCapital", 
	a."KeyStats_maxAge", 
	a."KeyStats_priceHint", 
	a."KeyStats_enterpriseValue", 
	a."KeyStats_forwardPE", 
	a."KeyStats_profitMargins", 
	a."KeyStats_floatShares", 
	a."KeyStats_sharesOutstanding", 
	a."KeyStats_sharesShort", 
	a."KeyStats_sharesShortPriorMonth", 
	a."KeyStats_sharesShortPreviousMonthDate", 
	a."KeyStats_dateShortInterest", 
	a."KeyStats_sharesPercentSharesOut", 
	a."KeyStats_heldPercentInsiders", 
	a."KeyStats_heldPercentInstitutions", 
	a."KeyStats_shortRatio", 
	a."KeyStats_shortPercentOfFloat", 
	a."KeyStats_beta", 
	a."KeyStats_impliedSharesOutstanding", 
	a."KeyStats_category", 
	a."KeyStats_bookValue", 
	a."KeyStats_priceToBook", 
	a."KeyStats_fundFamily", 
	a."KeyStats_legalType", 
	a."KeyStats_lastFiscalYearEnd", 
	a."KeyStats_nextFiscalYearEnd", 
	a."KeyStats_mostRecentQuarter", 
	a."KeyStats_earningsQuarterlyGrowth", 
	a."KeyStats_netIncomeToCommon", 
	a."KeyStats_trailingEps", 
	a."KeyStats_forwardEps", 
	a."KeyStats_lastSplitFactor", 
	a."KeyStats_lastSplitDate", 
	a."KeyStats_enterpriseToRevenue", 
	a."KeyStats_enterpriseToEbitda", 
	a."KeyStats_52WeekChange", 
	a."KeyStats_SandP52WeekChange", 
	a."KeyStats_lastDividendValue", 
	a."KeyStats_lastDividendDate", 
	a."KeyStats_latestShareClass", 
	a."KeyStats_leadInvestor", 
	a."Forward_EPS_Growth_Percent", 
	a."Summary_maxAge", 
	a."Summary_priceHint", 
	a."Summary_previousClose", 
	a."Summary_open", 
	a."Summary_dayLow", 
	a."Summary_dayHigh", 
	a."Summary_regularMarketPreviousClose", 
	a."Summary_regularMarketOpen", 
	a."Summary_regularMarketDayLow", 
	a."Summary_regularMarketDayHigh", 
	a."Summary_dividendRate", 
	a."Summary_dividendYield", 
	a."Summary_exDividendDate", 
	a."Summary_payoutRatio", 
	a."Summary_fiveYearAvgDividendYield", 
	a."Summary_beta", 
	a."Summary_trailingPE", 
	a."Summary_forwardPE", 
	a."Summary_volume", 
	a."Summary_regularMarketVolume", 
	a."Summary_averageVolume", 
	a."Summary_averageVolume10days", 
	a."Summary_averageDailyVolume10Day", 
	a."Summary_bid", 
	a."Summary_ask", 
	a."Summary_bidSize", 
	a."Summary_askSize", 
	a."Summary_marketCap", 
	a."Summary_fiftyTwoWeekLow", 
	a."Summary_fiftyTwoWeekHigh", 
	a."Summary_priceToSalesTrailing12Months", 
	a."Summary_fiftyDayAverage", 
	a."Summary_twoHundredDayAverage", 
	a."Summary_trailingAnnualDividendRate", 
	a."Summary_trailingAnnualDividendYield", 
	a."Summary_currency", 
	a."Summary_fromCurrency", 
	a."Summary_toCurrency", 
	a."Summary_lastMarket", 
	a."Summary_coinMarketCapLink", 
	a."Summary_algorithm", 
	a."Summary_tradeable", 
	a."FinData_maxAge", 
	a."FinData_currentPrice", 
	a."FinData_targetHighPrice", 
	a."FinData_targetLowPrice", 
	a."FinData_targetMeanPrice", 
	a."FinData_targetMedianPrice", 
	a."FinData_recommendationMean", 
	a."FinData_recommendationKey", 
	a."FinData_numberOfAnalystOpinions", 
	a."FinData_totalCash", 
	a."FinData_totalCashPerShare", 
	a."FinData_ebitda", 
	a."FinData_totalDebt", 
	a."FinData_quickRatio", 
	a."FinData_currentRatio", 
	a."FinData_totalRevenue", 
	a."FinData_debtToEquity", 
	a."FinData_revenuePerShare", 
	a."FinData_returnOnAssets", 
	a."FinData_returnOnEquity", 
	a."FinData_grossProfits", 
	a."FinData_freeCashflow", 
	a."FinData_operatingCashflow", 
	a."FinData_earningsGrowth", 
	a."FinData_revenueGrowth", 
	a."FinData_grossMargins", 
	a."FinData_ebitdaMargins", 
	a."FinData_operatingMargins", 
	a."FinData_profitMargins", 
	a."FinData_financialCurrency", 
	a."PE_Ratio_Calc", 
	a."PS_Ratio", 
	a."DebtToMarketCap", 
	a."EV_EBITDA_Approx",

	-- FundamentalDataDividendRadar
	CASE WHEN b.symbol IS NOT NULL THEN TRUE ELSE FALSE END as has_fundamental_data_dividend_radar,
	b."Company", 
	b."FV", 
	b."Sector", 
	b."No-Years", 
	b."Price", 
	b."Div-Yield", 
	b."5Y-Avg-Yield", 
	b."Current-Div", 
	b."Payouts/-Year", 
	b."Annualized", 
	b."Previous-Div", 
	b."Ex-Date", 
	b."Pay-Date", 
	b."Low", 
	b."High", 
	b."DGR-1Y", 
	b."DGR-3Y", 
	b."DGR-5Y", 
	b."DGR-10Y", 
	b."TTR-1Y", 
	b."TTR-3Y", 
	b."Fair-Value", 
	b."FV-%", 
	b."Streak-Basis", 
	b."Chowder-Number", 
	b."EPS-1Y", 
	b."Revenue-1Y", 
	b."NPM", 
	b."CF/Share", 
	b."ROE", 
	b."Current-R", 
	b."Debt/Capital", 
	b."ROTC", 
	b."P/E", 
	b."P/BV", 
	b."PEG", 
	b."New-Member", 
	b."Industry", 
	b."Classification"

FROM 
    FundamentalDataYahooProcessed as a
LEFT OUTER JOIN 
    FundamentalDataDividendRadar AS b
ON a.symbol = b.symbol;